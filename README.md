# Explainable Deep Learning for Portfolio Optimisation

## Metadata

- **University**: [King's College London](https://www.kcl.ac.uk)
- **Master's Programme**: [M.Sc. in Computational Finance](https://www.kcl.ac.uk/study/postgraduate-taught/courses/computational-finance-msc)
- **Student**: Ingrid PÃ©rez Aguilera
- **Supervisor**: [Riaz Ahmad](https://www.cqf.com/why-cqf/lecturers/our-faculty/dr-riaz-ahmad)

## Folder Structure

- `agents`: Module containing the implementation of the agents
- `benchmark`: Module containing the implementation of the benchmark strategies
- `config`: Configuration files
- `data`: Data files generated by running the examples
- `environments`: Module containing the implementation of the stock trading environment and portfolio optimisation environment
- `examples`: Jupyter notebooks demonstrating the use of the different modules
- `figures`: Folder containing the figures generated by running the examples
- `logs`: Folder containing the logs generated by running the examples, output of the TensorBoard for training the agents
- `preprocessor`: Module containing the implementation of the data downloading and preprocessing
- `report`: Latex files for the report
- `results`: Folder containing the results of the experiments, particularly the evaluation metrics
- `visualiser`: Module containing the implementation of the visualisation tools

## Setup Instructions

Pre-requisites:
- Python 3.12
- Virtual environment (optional but recommended). If not installed, you can install it using:
  ```bash
  pip install virtualenv
  ```


1. Clone the repository:
   ```bash
   git clone https://github.com/ingridpi/xdl-portfolio.git
   cd xdl-portfolio
   ```
2. Create a virtual environment (optional but recommended):
   ```bash
   python -m venv venv
   source venv/bin/activate
   ```
3. Install the required packages:
   ```bash
   pip install -r requirements.txt
   ```

## Usage Instructions

The recommended usage of the repo is to run the Jupyter notebooks in the `examples` folder. These notebooks demonstrate how to use the different modules and functionalities provided by the repo. 

1. Adjust the configurations in the `config/config.py` file as needed. This file contains the start and end dates for the data, the tickers to be used, and whether to use technical and macroeconomic indicators.

2. Run the Jupyter notebooks in the `examples` folder. Each notebook is self-contained and demonstrates a specific functionality or use case of the repo. However, there is a dependence on the order of execution, so it is recommended to run them sequentially.
1. `findownloader.ipynb`: Demonstrates how to download the data for the tickers specified in the `config/config.py` file.
1. `finpreprocessor.ipynb`: Demonstrates how to preprocess the data downloaded in the previous step. This includes calculating technical indicators, macroeconomic indicators, and other features.
1. `stock_trading.ipynb`: Demonstrates how to use the stock trading environment and train agents to trade stocks using reinforcement learning.
1. `portfolio_optimisation.ipynb`: Demonstrates how to use the portfolio optimisation environment and train agents to optimise a portfolio of stocks using reinforcement learning.
1. `backtesting.ipynb`: Demonstrates how to use the benchmark strategies and compare the performance of the trained agents against these benchmarks.

Moreover, the notebook `environment_agents.ipynb` provides an overview of the agents and stock trading environment provided by [FinRL](https://github.com/AI4Finance-Foundation/FinRL). Follow installation instructions in the [FinRL documentation](https://finrl.readthedocs.io/en/latest/start/installation.html) to set up their package before running the notebook. Note that it assumes that the notebooks `findownloader.ipynb` and `finpreprocessor.ipynb` have been run previously to download and preprocess the data.
